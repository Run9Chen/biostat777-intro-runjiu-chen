"0","set.seed(1)"
"0","nsim <- 10000; n <- 16; mu0 <- 5; sigma <- 1"
"0",""
"0","# Z 统计量（已知方差）"
"0","z <- replicate(nsim, {"
"0","  x <- rnorm(n, mean=mu0, sd=sigma)"
"0","  (mean(x) - mu0) / (sigma/sqrt(n))"
"0","})"
"0","p_one <- 1 - pnorm(z)          # Ha: mu > mu0（右尾）"
"0","p_two <- 2 * pnorm(-abs(z))    # 双侧"
"0",""
"0","# t 统计量（未知方差）"
"0","set.seed(2)"
"0","p_one_t <- p_two_t <- numeric(nsim)"
"0","for (i in 1:nsim) {"
"0","  x <- rnorm(n, mean=mu0, sd=sigma)"
"0","  tstat <- (mean(x)-mu0)/(sd(x)/sqrt(n))"
"0","  p_one_t[i] <- 1 - pt(tstat, df=n-1)"
"0","  p_two_t[i] <- 2 * pt(-abs(tstat), df=n-1)"
"0","}"
"0",""
"0","par(mfrow=c(1,2))"
"0","hist(p_one, breaks=20, freq=FALSE, main=""One-sided p under H0 (Z)"", xlab=""p"",col=""darkblue""); abline(h=1, lwd=2)"
