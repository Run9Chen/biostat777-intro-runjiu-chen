"0","set.seed(1)"
"0","nsim <- 10000; n <- 10; lambda <- 0.2; alpha <- 0.05"
"0","z <- qnorm(1 - alpha/2)"
"0",""
"0","cover_exact <- logical(nsim)"
"0","cover_wald  <- logical(nsim)"
"0","len_exact   <- numeric(nsim)"
"0","len_wald    <- numeric(nsim)"
"0",""
"0","for (i in 1:nsim) {"
"0","  y  <- rexp(n, rate=lambda)"
"0","  yb <- mean(y)"
"0","  lam_hat <- 1 / yb"
"0","  "
"0","  # exact CI via chi-square"
"0","  lo_ex <- qchisq(alpha/2, df=2*n) / (2*n*yb)"
"0","  hi_ex <- qchisq(1 - alpha/2, df=2*n) / (2*n*yb)"
"0","  cover_exact[i] <- (lambda >= lo_ex) & (lambda <= hi_ex)"
"0","  len_exact[i] <- hi_ex - lo_ex"
"0","  "
"0","  # Wald (Delta)"
"0","  se_hat <- lam_hat / sqrt(n)"
"0","  lo_w <- (1 - z / sqrt(n)) / yb"
"0","  hi_w<- (1 + z / sqrt(n)) / yb"
"0","  cover_wald[i] <- (lambda >= lo_w) & (lambda <= hi_w)"
"0","  len_wald[i] <- hi_w - lo_w"
"0","}"
"0",""
"0","c(Exact=mean(cover_exact), Wald=mean(cover_wald))"
"1"," Exact "
"1","  Wald "
"1","
"
"1","0.9478 "
"1","0.9516 "
"1","
"
"0","c(MeanLen_Exact=mean(len_exact), MeanLen_Wald=mean(len_wald))"
"1","MeanLen_Exact "
"1"," MeanLen_Wald "
"1","
"
"1","    0.2729737 "
"1","    0.2753389 "
"1","
"
