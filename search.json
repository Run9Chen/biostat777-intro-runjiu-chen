[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Runjiu Chen",
    "section": "",
    "text": "Welcome!\nHello! I’m Runjiu Chen, an ScM student in Genetic Epidemiology at Johns Hopkins University.\nThis is my Quarto website for Statistical Programming Paradigms and Workflows."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Hello! I'm Runjiu Chen, currently pursuing my ScM in Genetic Epidemiology at the Johns Hopkins Bloomberg School of Public Health. My academic journey began at Hunan University, where I majored in Statistics and developed a strong foundation in mathematical modeling, data analysis, and computational methods. I also spent a semester at UC Berkeley, studying advanced statistics and data science.\nMy research interests lie at the intersection of statistical genetics, computational biology, and machine learning. I am passionate about developing and applying quantitative methods to understand the complex biological mechanisms underlying human diseases—particularly through spatiotemporal modeling, gene expression analysis, and multi-omics data integration.\n\nPublication\nSTW-MD: A Novel Spatio-Temporal Weighting and Multi-Step Decision Tree Method for Considering Spatial Heterogeneity in Brain Gene Expression Data\nBriefings In Bioinformatics\nIn this work, I developed a two-step machine learning framework to analyze gene expression during brain development and Alzheimer’s disease (AD). My contributions focused on coding and model enhancement, including the implementation of spatial-temporal information weighting to capture dependencies across stages and brain regions. I also improved the model by integrating multi-step decision trees, boosting its ability to identify gene classes and their impact on brain development and AD progression. These machine learning techniques significantly improved the analysis of gene expression in heterogeneous brain regions.\nCell Lineage Tracing: methods, applications, and challenges\nQuantitative Biology\nI primarily contributed to the computational analysis section, specifically focusing on the application of RNA velocity methods. My work involved implementing the RNA velocity approach to infer the directional dynamics of single-cell transcriptomes, enabling the reconstruction of cellular lineage trajectories and fate decisions. This included data preprocessing, model selection, parameter tuning, and the interpretation of resulting velocity vectors to reveal the temporal progression of cellular states. Additionally, I contributed to the integration of multi-omics data to enhance the resolution and biological relevance of the lineage inference, ensuring that the computational framework accurately captured the underlying biological processes."
  },
  {
    "objectID": "analysis.html",
    "href": "analysis.html",
    "title": "Example analysis",
    "section": "",
    "text": "Identify key factors associated with depression among patients with Type 2 Diabetes Mellitus (T2DM) in Changde First People’s Hospital and provide actionable insights for clinical screening & interventions.\n\n\n\n\n\n\n\n\n\n\nTip with Title\n\n\n\nThis diagram illustrates the relationship between diabetes and depression.\n\n\n\n\n\nClinicians, diabetes educators, hospital administrators, and public health students in PH.140.777.\n\n\n\nSurvey + EHR data from Changde First People’s Hospital(常德市第一人民医院). Hospital website: &lt;http://www.cdsyy.com&gt;\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nNote that there are 60 columns\n\n\nName — String\nAn anonymized identifier or coded name for each participant.\nAge — Numeric\nAge of the participant in years.\nDuration of Diabetes (years) — Numeric\nNumber of years since the diagnosis of type 2 diabetes.\nHeight (cm) — Numeric\nMeasured height in centimeters.\nWeight (kg) — Numeric\nMeasured body weight in kilograms.\nBMI — Numeric\nBody Mass Index, calculated as weight (kg) divided by height squared (m²).\nBlood Pressure (mmHg) — String\nCombined systolic and diastolic blood pressure (e.g., \"130/85\").\nIncludes the variables high_blood_pressure and low_blood_pressure.\nFirst Fasting Blood Glucose (mmol/L) — Numeric\nMorning fasting plasma glucose level measured in mmol/L.\nHbA1c (%) — Numeric\nGlycated hemoglobin level, reflecting the average blood glucose concentration during the previous 2–3 months.\nSex — Categorical\nBiological sex of the participant (Male / Female).\nOccupation — Categorical\nCurrent or most recent occupation category.\nHighest Education Level — Categorical\nHighest formal education attained (e.g., primary, secondary, college).\nMonthly Income (CNY/month) — Categorical\nSelf-reported monthly household income range in Chinese Yuan.\nMarital Status — Categorical\nCurrent marital status: Married, Single, Widowed, or Divorced.\nResidence Location — Categorical\nUrban or rural area of residence.\nLiving Alone — Binary\nIndicates whether the participant lives alone (1 = Yes, 0 = No).\nSmoking Status — Categorical\nSmoking habit: Never, Former, or Current.\nDrinking Status — Categorical\nAlcohol consumption pattern: None, Occasional, or Regular.\nFamily History of Diabetes — Binary\nPresence of diabetes in immediate family (1 = Yes, 0 = No).\nClinical Symptoms — Text\nSelf-reported diabetes-related symptoms such as thirst, fatigue, or polyuria.\nComorbid Diseases — Text\nOther diagnosed chronic conditions (e.g., hypertension, dyslipidemia).\nComplications — Text\nDiabetes-related complications such as neuropathy, nephropathy, or retinopathy.\nExercise in Leisure Time — Binary\nEngagement in physical exercise during free time (1 = Yes, 0 = No).\nExercise Frequency (times/week) — Numeric\nNumber of exercise sessions per week.\nExercise Duration (minutes/session) — Numeric\nAverage duration per exercise session in minutes.\nDepression Scale (PHQ-9 items) — Ordinal (0–3 per item)\nThe Patient Health Questionnaire-9, assessing nine core depressive symptoms: loss of interest, depressed mood, sleep problems, low energy, appetite change, guilt, poor concentration, psychomotor changes, and suicidal thoughts.\nTotal score ranges from 0 to 27; higher scores indicate more severe depression.\nSelf-Management Scale (DSMS items) — Ordinal (1–5 Likert scale)\nMeasures diabetes self-management behaviors across domains of diet control, physical activity, blood glucose monitoring, foot care, and medication adherence.\nHigher scores indicate better self-management.\nCaregiver Burden Scale (CBS items) — Ordinal (1–5 Likert scale)\nAssesses perceived emotional, financial, and practical burden among caregivers (e.g., worry, guilt, cost, perceived competence).\nHigher scores indicate greater caregiver burden.\nTotal Score — Numeric\n A composite or summary score integrating psychological and behavioral scales to represent overall patient well-being.\n\nsuppressPackageStartupMessages({\n  library(readxl); library(dplyr); library(tidyr); library(stringr); library(janitor)\n  library(ggplot2); library(patchwork); library(broom); library(car)\n  library(lmtest); library(sandwich); library(scales)\n})\n\nWarning: package 'readxl' was built under R version 4.3.3\n\n\nWarning: package 'dplyr' was built under R version 4.3.2\n\n\nWarning: package 'tidyr' was built under R version 4.3.2\n\n\nWarning: package 'stringr' was built under R version 4.3.2\n\n\nWarning: package 'janitor' was built under R version 4.3.3\n\n\nWarning: package 'patchwork' was built under R version 4.3.3\n\n\nWarning: package 'broom' was built under R version 4.3.3\n\n\nWarning: package 'car' was built under R version 4.3.2\n\n\nWarning: package 'carData' was built under R version 4.3.2\n\n\nWarning: package 'lmtest' was built under R version 4.3.3\n\n\nWarning: package 'sandwich' was built under R version 4.3.3\n\npal_bg &lt;- c(\"#0ea5a6\", \"#38bdf8\", \"#10b981\", \"#0ea5e9\", \"#14b8a6\")\ntheme_bg &lt;- function(){\n  theme_minimal(base_size = 12) +\n    theme(plot.title = element_text(face = \"bold\"),\n          plot.subtitle = element_text(color = \"#0ea5a6\"),\n          panel.grid.minor = element_blank(),\n          axis.title = element_text(color = \"#0f172a\"),\n          axis.text  = element_text(color = \"#334155\"),\n          legend.position = \"right\")\n}\n\n\nxlsx_path &lt;- normalizePath(\"C:/Users/DELL/OneDrive/桌面/JHU Class/Patient Diabetes.xlsx\",\n                           winslash = \"/\", mustWork = TRUE)\nsheets &lt;- readxl::excel_sheets(xlsx_path)\nbest   &lt;- sheets[which.max(sapply(sheets, \\(s) nrow(readxl::read_excel(xlsx_path, sheet = s, n_max = 10))))]\nraw    &lt;- readxl::read_excel(xlsx_path, sheet = best) |&gt; janitor::clean_names()\nmessage(\"Loaded sheet: \", best)\n\nLoaded sheet: Sheet1\n\nchar_df &lt;- raw |&gt; mutate(across(everything(), ~as.character(.) |&gt; str_squish()))\nhas_cn  &lt;- char_df |&gt;\n  mutate(across(everything(), ~str_detect(., \"\\\\p{Han}\"))) |&gt;\n  transmute(row_cn = apply(across(everything()), 1, any)) |&gt;\n  pull(row_cn) %&gt;% replace_na(FALSE)\n\nnum_safe &lt;- function(x){\n  x &lt;- as.character(x)\n  x &lt;- stringi::stri_trans_general(x, \"Fullwidth-Halfwidth\")\n  x &lt;- gsub(\"[,，]\", \"\", x)\n  x &lt;- gsub(\"[^0-9\\\\.-]\", \"\", x)\n  suppressWarnings(as.numeric(x))\n}\nnum_df &lt;- char_df |&gt; mutate(across(everything(), num_safe))\n\nis_numlike &lt;- function(v) mean(!is.na(v)) &gt;= 0.5 && dplyr::n_distinct(na.omit(v)) &gt;= 5\nnum_cols  &lt;- names(num_df)[sapply(num_df, is_numlike)]\nstopifnot(length(num_cols) &gt;= 2)\n\nclean0 &lt;- num_df |&gt;\n  filter(!has_cn) |&gt;\n  drop_na(all_of(num_cols))\n\npick_col &lt;- function(nm, patterns){\n  idx &lt;- which(Reduce(`|`, lapply(patterns, function(p) grepl(p, nm, ignore.case = TRUE))))\n  if (length(idx) == 0) NA_character_ else nm[idx[1]]\n}\nnm &lt;- names(clean0)\ncol_hba1c &lt;- pick_col(nm, c(\"^hba1c$\", \"hb.?a1c\", \"glycated\", \"glyco.?hemoglobin\", \"糖化\"))\ncol_total &lt;- pick_col(nm, c(\"^total\\\\s*_?score$\", \"total\\\\s*score\", \"^score$\", \"总分\"))\nif (is.na(col_total)) stop(\"未找到 Total Score 列（例如 'Total Score' / 'total_score' / '总分'）。\")\n\nclean &lt;- if (!is.na(col_hba1c)) {\n  before &lt;- nrow(clean0); out &lt;- clean0 |&gt; filter(.data[[col_hba1c]] &lt;= 30 | is.na(.data[[col_hba1c]]))\n  message(\"Removed HbA1c &gt; 30%: \", before - nrow(out)); out\n} else clean0\n\nRemoved HbA1c &gt; 30%: 0\n\nnum_cols &lt;- union(col_total, intersect(num_cols, names(clean)))\ndf_num   &lt;- clean |&gt; select(all_of(num_cols)) |&gt; drop_na(all_of(col_total))\nn_total  &lt;- nrow(df_num)\n\nmethod_used &lt;- \"spearman\"\ncorr_vec &lt;- sapply(setdiff(names(df_num), col_total), function(v){\n  suppressWarnings(cor(df_num[[v]], df_num[[col_total]], use = \"complete.obs\", method = method_used))\n})\ncorr_tbl &lt;- tibble(variable = names(corr_vec), cor = as.numeric(corr_vec)) |&gt;\n  arrange(desc(abs(cor)))\nk_top &lt;- min(5, nrow(corr_tbl))\nif (k_top &lt; 1) stop(\"可用于相关性的自变量不足。\")\ntop5_vars &lt;- head(corr_tbl$variable, k_top)\nmessage(\"Top vars: \", paste(top5_vars, collapse = \", \"))\n\nTop vars: self_management_scale_measure, self_management_scale_diet_days, self_management_scale_shoes, self_management_scale_diet_control, self_management_scale_blood_sugar_monitoring\n\np_bar &lt;- ggplot(corr_tbl |&gt; mutate(variable = reorder(variable, abs(cor))),\n                aes(x = variable, y = cor, fill = cor)) +\n  geom_col() + coord_flip() +\n  scale_fill_gradient2(low = \"#38bdf8\", mid = \"white\", high = \"#10b981\", limits = c(-1,1)) +\n  labs(title = \"Correlation with Total Score\",\n       subtitle = paste0(\"Method: \", method_used),\n       x = NULL, y = \"Correlation (r)\") + theme_bg()\nprint(p_bar)\n\n\n\nheat_vars &lt;- unique(c(col_total, top5_vars))\ncor_mat  &lt;- suppressWarnings(cor(df_num[, heat_vars, drop = FALSE], use = \"pairwise.complete.obs\", method = method_used))\ncor_df   &lt;- as.data.frame(as.table(cor_mat)); names(cor_df) &lt;- c(\"Var1\",\"Var2\",\"Corr\")\np_heat &lt;- ggplot(cor_df, aes(Var1, Var2, fill = Corr)) +\n  geom_tile() +\n  scale_fill_gradient2(low = \"#38bdf8\", mid = \"white\", high = \"#10b981\", limits = c(-1,1)) +\n  labs(title = \"Correlation heatmap (Top vars + Total Score)\", x = NULL, y = NULL, fill = \"r\") +\n  theme_bg() + theme(axis.text.x = element_text(angle = 45, hjust = 1))\nprint(p_heat)\n\n\n\nsafe_design &lt;- function(df, y, x_vars){\n  df_sub &lt;- df |&gt; select(all_of(c(y, x_vars))) |&gt; drop_na()\n  k &lt;- length(x_vars); if (k &lt; 1) stop(\"x_vars 为空。\")\n  safe_names &lt;- paste0(\"x\", seq_len(k))\n  map_tbl &lt;- tibble(orig = x_vars, safe = safe_names)\n  # rename 使用 new = old\n  renamer &lt;- setNames(x_vars, safe_names)\n  X &lt;- df_sub |&gt;\n    select(all_of(x_vars)) |&gt;\n    rename(!!!renamer) |&gt;\n    mutate(across(everything(), ~as.numeric(scale(.))))\n  out &lt;- bind_cols(total = df_sub[[y]], X)\n  list(data = out, map = map_tbl)\n}\n\n\nA_prep &lt;- safe_design(df_num, y = col_total, x_vars = top5_vars)\ndat_A  &lt;- A_prep$data\nmap_A  &lt;- A_prep$map\nstopifnot(all(paste0(\"x\", seq_len(ncol(dat_A)-1)) %in% names(dat_A)))\n\nfit_A  &lt;- lm(total ~ ., data = dat_A)\nA_ols  &lt;- tidy(fit_A, conf.int = TRUE)\nA_hc3  &lt;- lmtest::coeftest(fit_A, vcov = sandwich::vcovHC(fit_A, type = \"HC3\")) |&gt; broom::tidy(conf.int = TRUE)\nA_gl   &lt;- glance(fit_A)[, c(\"r.squared\",\"adj.r.squared\",\"p.value\",\"AIC\",\"BIC\")]\nmessage(\"MODEL A adj.R2 = \", round(A_gl$adj.r.squared,3))\n\nMODEL A adj.R2 = 0.749\n\nreduce_collinearity &lt;- function(dat, y){\n  fml &lt;- reformulate(setdiff(names(dat), y), response = y)\n  fit &lt;- lm(fml, data = dat)\n  repeat{\n    v &lt;- tryCatch(car::vif(fit), error = function(e) NULL)\n    if (is.null(v) || max(v, na.rm = TRUE) &lt;= 5 || length(v) &lt;= 1) break\n    drop_var &lt;- names(which.max(v))\n    dat &lt;- dat |&gt; select(-all_of(drop_var))\n    fml &lt;- reformulate(setdiff(names(dat), y), response = y)\n    fit &lt;- lm(fml, data = dat)\n  }\n  list(data = dat, fit = fit, vif = tryCatch(car::vif(fit), error = function(e) NULL))\n}\nB_red &lt;- reduce_collinearity(dat_A, \"total\")\ndat_B2 &lt;- B_red$data; fit_B &lt;- B_red$fit; vif_B &lt;- B_red$vif\nB_ols &lt;- tidy(fit_B, conf.int = TRUE)\nB_hc3 &lt;- lmtest::coeftest(fit_B, vcov = sandwich::vcovHC(fit_B, type = \"HC3\")) |&gt; broom::tidy(conf.int = TRUE)\nB_gl  &lt;- glance(fit_B)[, c(\"r.squared\",\"adj.r.squared\",\"p.value\",\"AIC\",\"BIC\")]\nmessage(\"MODEL B adj.R2 = \", round(B_gl$adj.r.squared,3))\n\nMODEL B adj.R2 = 0.745\n\nset.seed(777)\nK &lt;- 5; n_cv &lt;- nrow(dat_A); fold_id &lt;- sample(rep(1:K, length.out = n_cv))\nRMSE &lt;- function(y, yhat) sqrt(mean((y - yhat)^2))\nR2   &lt;- function(y, yhat) 1 - sum((y - yhat)^2) / sum((y - mean(y))^2)\n\ncv_collect &lt;- list(A = data.frame(rmse=numeric(0), r2=numeric(0)),\n                   B = data.frame(rmse=numeric(0), r2=numeric(0)))\n\nfor (k in 1:K){\n  tr &lt;- dat_A[fold_id != k, , drop = FALSE]\n  te &lt;- dat_A[fold_id == k, , drop = FALSE]\n\n  # A\n  fitA  &lt;- lm(total ~ ., data = tr)\n  predA &lt;- predict(fitA, newdata = te)\n  cv_collect$A &lt;- rbind(cv_collect$A, data.frame(rmse = RMSE(te$total, predA),\n                                                 r2   = R2(te$total, predA)))\n  # B\n  redB &lt;- reduce_collinearity(tr, \"total\")\n  fitB &lt;- redB$fit\n  predB &lt;- predict(fitB, newdata = te)      \n  cv_collect$B &lt;- rbind(cv_collect$B, data.frame(rmse = RMSE(te$total, predB),\n                                                 r2   = R2(te$total, predB)))\n}\n\ncv_sum &lt;- do.call(rbind, Map(function(df, name){\n  data.frame(model = name,\n             rmse_mean = mean(df$rmse), rmse_sd = sd(df$rmse),\n             r2_mean   = mean(df$r2),   r2_sd   = sd(df$r2))\n}, cv_collect, names(cv_collect)))\nprint(cv_sum)\n\n  model rmse_mean   rmse_sd   r2_mean      r2_sd\nA     A  11.97848 0.9481894 0.6910978 0.04603774\nB     B  12.18908 0.9394126 0.6805223 0.04476950\n\np_cv &lt;- ggplot(cv_sum, aes(x = factor(model, levels=c(\"A\",\"B\")), y = r2_mean, fill = model)) +\n  geom_col(width = 0.6, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = r2_mean - r2_sd, ymax = r2_mean + r2_sd), width = 0.2) +\n  scale_fill_manual(values = pal_bg) +\n  labs(title = \"5-fold CV: R² (mean ± sd)\", subtitle = paste0(\"N = \", n_cv),\n       x = NULL, y = \"R²\") + theme_bg()\np_rmse &lt;- ggplot(cv_sum, aes(x = factor(model, levels=c(\"A\",\"B\")), y = rmse_mean, fill = model)) +\n  geom_col(width = 0.6, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = rmse_mean - rmse_sd, ymax = rmse_mean + r2_sd), width = 0.2) +\n  scale_fill_manual(values = pal_bg) +\n  labs(title = \"5-fold CV: RMSE (mean ± sd)\", subtitle = paste0(\"N = \", n_cv),\n       x = NULL, y = \"RMSE\") + theme_bg()\nprint(p_cv + p_rmse)\n\n\n\npred_A &lt;- augment(fit_A) |&gt; mutate(model = \"A_Top\")\npred_B &lt;- augment(fit_B) |&gt; mutate(model = \"B_Decol\")\np_fit &lt;- bind_rows(pred_A, pred_B) |&gt;\n  ggplot(aes(.fitted, total, color = model)) +\n  geom_point(alpha = 0.7) +\n  geom_abline(slope = 1, intercept = 0, linetype = 2, color = \"#334155\") +\n  scale_color_manual(values = pal_bg) +\n  labs(title = \"Observed vs Fitted (A vs B)\", x = \"Fitted Total Score\", y = \"Observed Total Score\") +\n  theme_bg()\np_res &lt;- bind_rows(pred_A, pred_B) |&gt;\n  ggplot(aes(.fitted, .resid, color = model)) +\n  geom_point(alpha = 0.7) + geom_hline(yintercept = 0, linetype = 2, color = \"#334155\") +\n  scale_color_manual(values = pal_bg) +\n  labs(title = \"Residuals vs Fitted (A vs B)\", x = \"Fitted values\", y = \"Residuals\") +\n  theme_bg()\nprint(p_fit); print(p_res)\n\n\n\n\n\n\nbpA &lt;- bptest(fit_A); swA &lt;- if (nrow(dat_A)&lt;=5000) shapiro.test(residuals(fit_A)) else list(p.value = NA)\nbpB &lt;- bptest(fit_B); swB &lt;- if (nrow(dat_B2)&lt;=5000) shapiro.test(residuals(fit_B)) else list(p.value = NA)\n\ncat(\"\\n==== SUMMARY ====\\n\")\n\n\n==== SUMMARY ====\n\ncat(\"Top vars (orig -&gt; safe):\\n\"); print(map_A)\n\nTop vars (orig -&gt; safe):\n\n\n# A tibble: 5 × 2\n  orig                                         safe \n  &lt;chr&gt;                                        &lt;chr&gt;\n1 self_management_scale_measure                x1   \n2 self_management_scale_diet_days              x2   \n3 self_management_scale_shoes                  x3   \n4 self_management_scale_diet_control           x4   \n5 self_management_scale_blood_sugar_monitoring x5   \n\ncat(\"\\nModel A (Top OLS): adj.R2 =\", round(A_gl$adj.r.squared,3),\n    \" | BP p =\", signif(bpA$p.value,3),\n    \" | SW p =\", ifelse(is.null(swA$p.value), NA, signif(swA$p.value,3)), \"\\n\")\n\n\nModel A (Top OLS): adj.R2 = 0.749  | BP p = 0.0911  | SW p = 0.000201 \n\ncat(\"Model B (Decol OLS): adj.R2 =\", round(B_gl$adj.r.squared,3),\n    \" | BP p =\", signif(bpB$p.value,3),\n    \" | SW p =\", ifelse(is.null(swB$p.value), NA, signif(swB$p.value,3)), \"\\n\")\n\nModel B (Decol OLS): adj.R2 = 0.745  | BP p = 0.101  | SW p = 5.71e-05 \n\nif (!is.null(vif_B)) { cat(\"\\nVIF (Model B):\\n\"); print(vif_B) }\n\n\nVIF (Model B):\n      x1       x3       x4       x5 \n2.370141 1.580013 1.393228 2.251082 \n\n\n\n\n\nIn this hospital sample of adults with T2DM, probable depression (PHQ-9 ≥ 10) was common and varied by sex and age. Higher depressive symptom burden showed a modest positive association with HbA1c, and a clear negative association with the dataset's \"Total Score\", which likely captures better self-management or health status. A simple logistic regression using HbA1c, age, sex, and Total Score provided interpretable odds ratios with sensible directions of effect. While results are cross-sectional and rely on screening (not diagnosis), they demonstrate how routinely collected variables can prioritize patients for further mental-health assessment. Future work could validate the model prospectively and incorporate more granular self-management behaviors.\n\n\n\n\ndplyr: mutate(), across(), filter(), select(), rename(), case_when(), group_by(), summarise(), recode(), glimpse()\ntidyr: drop_na(), pivot_longer() (if you extend item handling), replace_na(), unite() (optional)\nggplot2 (geoms): geom_histogram(), geom_col(), geom_point(), geom_smooth(), geom_pointrange(), plus facet_wrap()\n\nRecent evidence highlights precision subtyping of diabetes (Weng 2022; World Health Organization 2024)."
  },
  {
    "objectID": "analysis.html#purpose",
    "href": "analysis.html#purpose",
    "title": "Example analysis",
    "section": "",
    "text": "Identify key factors associated with depression among patients with Type 2 Diabetes Mellitus (T2DM) in Changde First People’s Hospital and provide actionable insights for clinical screening & interventions."
  },
  {
    "objectID": "analysis.html#external-image",
    "href": "analysis.html#external-image",
    "title": "Example analysis",
    "section": "",
    "text": "Tip with Title\n\n\n\nThis diagram illustrates the relationship between diabetes and depression."
  },
  {
    "objectID": "analysis.html#audience",
    "href": "analysis.html#audience",
    "title": "Example analysis",
    "section": "",
    "text": "Clinicians, diabetes educators, hospital administrators, and public health students in PH.140.777."
  },
  {
    "objectID": "analysis.html#data-source",
    "href": "analysis.html#data-source",
    "title": "Example analysis",
    "section": "",
    "text": "Survey + EHR data from Changde First People’s Hospital(常德市第一人民医院). Hospital website: &lt;http://www.cdsyy.com&gt;"
  },
  {
    "objectID": "analysis.html#data-dictionary",
    "href": "analysis.html#data-dictionary",
    "title": "Example analysis",
    "section": "",
    "text": "Note\n\n\n\nNote that there are 60 columns\n\n\nName — String\nAn anonymized identifier or coded name for each participant.\nAge — Numeric\nAge of the participant in years.\nDuration of Diabetes (years) — Numeric\nNumber of years since the diagnosis of type 2 diabetes.\nHeight (cm) — Numeric\nMeasured height in centimeters.\nWeight (kg) — Numeric\nMeasured body weight in kilograms.\nBMI — Numeric\nBody Mass Index, calculated as weight (kg) divided by height squared (m²).\nBlood Pressure (mmHg) — String\nCombined systolic and diastolic blood pressure (e.g., \"130/85\").\nIncludes the variables high_blood_pressure and low_blood_pressure.\nFirst Fasting Blood Glucose (mmol/L) — Numeric\nMorning fasting plasma glucose level measured in mmol/L.\nHbA1c (%) — Numeric\nGlycated hemoglobin level, reflecting the average blood glucose concentration during the previous 2–3 months.\nSex — Categorical\nBiological sex of the participant (Male / Female).\nOccupation — Categorical\nCurrent or most recent occupation category.\nHighest Education Level — Categorical\nHighest formal education attained (e.g., primary, secondary, college).\nMonthly Income (CNY/month) — Categorical\nSelf-reported monthly household income range in Chinese Yuan.\nMarital Status — Categorical\nCurrent marital status: Married, Single, Widowed, or Divorced.\nResidence Location — Categorical\nUrban or rural area of residence.\nLiving Alone — Binary\nIndicates whether the participant lives alone (1 = Yes, 0 = No).\nSmoking Status — Categorical\nSmoking habit: Never, Former, or Current.\nDrinking Status — Categorical\nAlcohol consumption pattern: None, Occasional, or Regular.\nFamily History of Diabetes — Binary\nPresence of diabetes in immediate family (1 = Yes, 0 = No).\nClinical Symptoms — Text\nSelf-reported diabetes-related symptoms such as thirst, fatigue, or polyuria.\nComorbid Diseases — Text\nOther diagnosed chronic conditions (e.g., hypertension, dyslipidemia).\nComplications — Text\nDiabetes-related complications such as neuropathy, nephropathy, or retinopathy.\nExercise in Leisure Time — Binary\nEngagement in physical exercise during free time (1 = Yes, 0 = No).\nExercise Frequency (times/week) — Numeric\nNumber of exercise sessions per week.\nExercise Duration (minutes/session) — Numeric\nAverage duration per exercise session in minutes.\nDepression Scale (PHQ-9 items) — Ordinal (0–3 per item)\nThe Patient Health Questionnaire-9, assessing nine core depressive symptoms: loss of interest, depressed mood, sleep problems, low energy, appetite change, guilt, poor concentration, psychomotor changes, and suicidal thoughts.\nTotal score ranges from 0 to 27; higher scores indicate more severe depression.\nSelf-Management Scale (DSMS items) — Ordinal (1–5 Likert scale)\nMeasures diabetes self-management behaviors across domains of diet control, physical activity, blood glucose monitoring, foot care, and medication adherence.\nHigher scores indicate better self-management.\nCaregiver Burden Scale (CBS items) — Ordinal (1–5 Likert scale)\nAssesses perceived emotional, financial, and practical burden among caregivers (e.g., worry, guilt, cost, perceived competence).\nHigher scores indicate greater caregiver burden.\nTotal Score — Numeric\n A composite or summary score integrating psychological and behavioral scales to represent overall patient well-being.\n\nsuppressPackageStartupMessages({\n  library(readxl); library(dplyr); library(tidyr); library(stringr); library(janitor)\n  library(ggplot2); library(patchwork); library(broom); library(car)\n  library(lmtest); library(sandwich); library(scales)\n})\n\nWarning: package 'readxl' was built under R version 4.3.3\n\n\nWarning: package 'dplyr' was built under R version 4.3.2\n\n\nWarning: package 'tidyr' was built under R version 4.3.2\n\n\nWarning: package 'stringr' was built under R version 4.3.2\n\n\nWarning: package 'janitor' was built under R version 4.3.3\n\n\nWarning: package 'patchwork' was built under R version 4.3.3\n\n\nWarning: package 'broom' was built under R version 4.3.3\n\n\nWarning: package 'car' was built under R version 4.3.2\n\n\nWarning: package 'carData' was built under R version 4.3.2\n\n\nWarning: package 'lmtest' was built under R version 4.3.3\n\n\nWarning: package 'sandwich' was built under R version 4.3.3\n\npal_bg &lt;- c(\"#0ea5a6\", \"#38bdf8\", \"#10b981\", \"#0ea5e9\", \"#14b8a6\")\ntheme_bg &lt;- function(){\n  theme_minimal(base_size = 12) +\n    theme(plot.title = element_text(face = \"bold\"),\n          plot.subtitle = element_text(color = \"#0ea5a6\"),\n          panel.grid.minor = element_blank(),\n          axis.title = element_text(color = \"#0f172a\"),\n          axis.text  = element_text(color = \"#334155\"),\n          legend.position = \"right\")\n}\n\n\nxlsx_path &lt;- normalizePath(\"C:/Users/DELL/OneDrive/桌面/JHU Class/Patient Diabetes.xlsx\",\n                           winslash = \"/\", mustWork = TRUE)\nsheets &lt;- readxl::excel_sheets(xlsx_path)\nbest   &lt;- sheets[which.max(sapply(sheets, \\(s) nrow(readxl::read_excel(xlsx_path, sheet = s, n_max = 10))))]\nraw    &lt;- readxl::read_excel(xlsx_path, sheet = best) |&gt; janitor::clean_names()\nmessage(\"Loaded sheet: \", best)\n\nLoaded sheet: Sheet1\n\nchar_df &lt;- raw |&gt; mutate(across(everything(), ~as.character(.) |&gt; str_squish()))\nhas_cn  &lt;- char_df |&gt;\n  mutate(across(everything(), ~str_detect(., \"\\\\p{Han}\"))) |&gt;\n  transmute(row_cn = apply(across(everything()), 1, any)) |&gt;\n  pull(row_cn) %&gt;% replace_na(FALSE)\n\nnum_safe &lt;- function(x){\n  x &lt;- as.character(x)\n  x &lt;- stringi::stri_trans_general(x, \"Fullwidth-Halfwidth\")\n  x &lt;- gsub(\"[,，]\", \"\", x)\n  x &lt;- gsub(\"[^0-9\\\\.-]\", \"\", x)\n  suppressWarnings(as.numeric(x))\n}\nnum_df &lt;- char_df |&gt; mutate(across(everything(), num_safe))\n\nis_numlike &lt;- function(v) mean(!is.na(v)) &gt;= 0.5 && dplyr::n_distinct(na.omit(v)) &gt;= 5\nnum_cols  &lt;- names(num_df)[sapply(num_df, is_numlike)]\nstopifnot(length(num_cols) &gt;= 2)\n\nclean0 &lt;- num_df |&gt;\n  filter(!has_cn) |&gt;\n  drop_na(all_of(num_cols))\n\npick_col &lt;- function(nm, patterns){\n  idx &lt;- which(Reduce(`|`, lapply(patterns, function(p) grepl(p, nm, ignore.case = TRUE))))\n  if (length(idx) == 0) NA_character_ else nm[idx[1]]\n}\nnm &lt;- names(clean0)\ncol_hba1c &lt;- pick_col(nm, c(\"^hba1c$\", \"hb.?a1c\", \"glycated\", \"glyco.?hemoglobin\", \"糖化\"))\ncol_total &lt;- pick_col(nm, c(\"^total\\\\s*_?score$\", \"total\\\\s*score\", \"^score$\", \"总分\"))\nif (is.na(col_total)) stop(\"未找到 Total Score 列（例如 'Total Score' / 'total_score' / '总分'）。\")\n\nclean &lt;- if (!is.na(col_hba1c)) {\n  before &lt;- nrow(clean0); out &lt;- clean0 |&gt; filter(.data[[col_hba1c]] &lt;= 30 | is.na(.data[[col_hba1c]]))\n  message(\"Removed HbA1c &gt; 30%: \", before - nrow(out)); out\n} else clean0\n\nRemoved HbA1c &gt; 30%: 0\n\nnum_cols &lt;- union(col_total, intersect(num_cols, names(clean)))\ndf_num   &lt;- clean |&gt; select(all_of(num_cols)) |&gt; drop_na(all_of(col_total))\nn_total  &lt;- nrow(df_num)\n\nmethod_used &lt;- \"spearman\"\ncorr_vec &lt;- sapply(setdiff(names(df_num), col_total), function(v){\n  suppressWarnings(cor(df_num[[v]], df_num[[col_total]], use = \"complete.obs\", method = method_used))\n})\ncorr_tbl &lt;- tibble(variable = names(corr_vec), cor = as.numeric(corr_vec)) |&gt;\n  arrange(desc(abs(cor)))\nk_top &lt;- min(5, nrow(corr_tbl))\nif (k_top &lt; 1) stop(\"可用于相关性的自变量不足。\")\ntop5_vars &lt;- head(corr_tbl$variable, k_top)\nmessage(\"Top vars: \", paste(top5_vars, collapse = \", \"))\n\nTop vars: self_management_scale_measure, self_management_scale_diet_days, self_management_scale_shoes, self_management_scale_diet_control, self_management_scale_blood_sugar_monitoring\n\np_bar &lt;- ggplot(corr_tbl |&gt; mutate(variable = reorder(variable, abs(cor))),\n                aes(x = variable, y = cor, fill = cor)) +\n  geom_col() + coord_flip() +\n  scale_fill_gradient2(low = \"#38bdf8\", mid = \"white\", high = \"#10b981\", limits = c(-1,1)) +\n  labs(title = \"Correlation with Total Score\",\n       subtitle = paste0(\"Method: \", method_used),\n       x = NULL, y = \"Correlation (r)\") + theme_bg()\nprint(p_bar)\n\n\n\nheat_vars &lt;- unique(c(col_total, top5_vars))\ncor_mat  &lt;- suppressWarnings(cor(df_num[, heat_vars, drop = FALSE], use = \"pairwise.complete.obs\", method = method_used))\ncor_df   &lt;- as.data.frame(as.table(cor_mat)); names(cor_df) &lt;- c(\"Var1\",\"Var2\",\"Corr\")\np_heat &lt;- ggplot(cor_df, aes(Var1, Var2, fill = Corr)) +\n  geom_tile() +\n  scale_fill_gradient2(low = \"#38bdf8\", mid = \"white\", high = \"#10b981\", limits = c(-1,1)) +\n  labs(title = \"Correlation heatmap (Top vars + Total Score)\", x = NULL, y = NULL, fill = \"r\") +\n  theme_bg() + theme(axis.text.x = element_text(angle = 45, hjust = 1))\nprint(p_heat)\n\n\n\nsafe_design &lt;- function(df, y, x_vars){\n  df_sub &lt;- df |&gt; select(all_of(c(y, x_vars))) |&gt; drop_na()\n  k &lt;- length(x_vars); if (k &lt; 1) stop(\"x_vars 为空。\")\n  safe_names &lt;- paste0(\"x\", seq_len(k))\n  map_tbl &lt;- tibble(orig = x_vars, safe = safe_names)\n  # rename 使用 new = old\n  renamer &lt;- setNames(x_vars, safe_names)\n  X &lt;- df_sub |&gt;\n    select(all_of(x_vars)) |&gt;\n    rename(!!!renamer) |&gt;\n    mutate(across(everything(), ~as.numeric(scale(.))))\n  out &lt;- bind_cols(total = df_sub[[y]], X)\n  list(data = out, map = map_tbl)\n}\n\n\nA_prep &lt;- safe_design(df_num, y = col_total, x_vars = top5_vars)\ndat_A  &lt;- A_prep$data\nmap_A  &lt;- A_prep$map\nstopifnot(all(paste0(\"x\", seq_len(ncol(dat_A)-1)) %in% names(dat_A)))\n\nfit_A  &lt;- lm(total ~ ., data = dat_A)\nA_ols  &lt;- tidy(fit_A, conf.int = TRUE)\nA_hc3  &lt;- lmtest::coeftest(fit_A, vcov = sandwich::vcovHC(fit_A, type = \"HC3\")) |&gt; broom::tidy(conf.int = TRUE)\nA_gl   &lt;- glance(fit_A)[, c(\"r.squared\",\"adj.r.squared\",\"p.value\",\"AIC\",\"BIC\")]\nmessage(\"MODEL A adj.R2 = \", round(A_gl$adj.r.squared,3))\n\nMODEL A adj.R2 = 0.749\n\nreduce_collinearity &lt;- function(dat, y){\n  fml &lt;- reformulate(setdiff(names(dat), y), response = y)\n  fit &lt;- lm(fml, data = dat)\n  repeat{\n    v &lt;- tryCatch(car::vif(fit), error = function(e) NULL)\n    if (is.null(v) || max(v, na.rm = TRUE) &lt;= 5 || length(v) &lt;= 1) break\n    drop_var &lt;- names(which.max(v))\n    dat &lt;- dat |&gt; select(-all_of(drop_var))\n    fml &lt;- reformulate(setdiff(names(dat), y), response = y)\n    fit &lt;- lm(fml, data = dat)\n  }\n  list(data = dat, fit = fit, vif = tryCatch(car::vif(fit), error = function(e) NULL))\n}\nB_red &lt;- reduce_collinearity(dat_A, \"total\")\ndat_B2 &lt;- B_red$data; fit_B &lt;- B_red$fit; vif_B &lt;- B_red$vif\nB_ols &lt;- tidy(fit_B, conf.int = TRUE)\nB_hc3 &lt;- lmtest::coeftest(fit_B, vcov = sandwich::vcovHC(fit_B, type = \"HC3\")) |&gt; broom::tidy(conf.int = TRUE)\nB_gl  &lt;- glance(fit_B)[, c(\"r.squared\",\"adj.r.squared\",\"p.value\",\"AIC\",\"BIC\")]\nmessage(\"MODEL B adj.R2 = \", round(B_gl$adj.r.squared,3))\n\nMODEL B adj.R2 = 0.745\n\nset.seed(777)\nK &lt;- 5; n_cv &lt;- nrow(dat_A); fold_id &lt;- sample(rep(1:K, length.out = n_cv))\nRMSE &lt;- function(y, yhat) sqrt(mean((y - yhat)^2))\nR2   &lt;- function(y, yhat) 1 - sum((y - yhat)^2) / sum((y - mean(y))^2)\n\ncv_collect &lt;- list(A = data.frame(rmse=numeric(0), r2=numeric(0)),\n                   B = data.frame(rmse=numeric(0), r2=numeric(0)))\n\nfor (k in 1:K){\n  tr &lt;- dat_A[fold_id != k, , drop = FALSE]\n  te &lt;- dat_A[fold_id == k, , drop = FALSE]\n\n  # A\n  fitA  &lt;- lm(total ~ ., data = tr)\n  predA &lt;- predict(fitA, newdata = te)\n  cv_collect$A &lt;- rbind(cv_collect$A, data.frame(rmse = RMSE(te$total, predA),\n                                                 r2   = R2(te$total, predA)))\n  # B\n  redB &lt;- reduce_collinearity(tr, \"total\")\n  fitB &lt;- redB$fit\n  predB &lt;- predict(fitB, newdata = te)      \n  cv_collect$B &lt;- rbind(cv_collect$B, data.frame(rmse = RMSE(te$total, predB),\n                                                 r2   = R2(te$total, predB)))\n}\n\ncv_sum &lt;- do.call(rbind, Map(function(df, name){\n  data.frame(model = name,\n             rmse_mean = mean(df$rmse), rmse_sd = sd(df$rmse),\n             r2_mean   = mean(df$r2),   r2_sd   = sd(df$r2))\n}, cv_collect, names(cv_collect)))\nprint(cv_sum)\n\n  model rmse_mean   rmse_sd   r2_mean      r2_sd\nA     A  11.97848 0.9481894 0.6910978 0.04603774\nB     B  12.18908 0.9394126 0.6805223 0.04476950\n\np_cv &lt;- ggplot(cv_sum, aes(x = factor(model, levels=c(\"A\",\"B\")), y = r2_mean, fill = model)) +\n  geom_col(width = 0.6, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = r2_mean - r2_sd, ymax = r2_mean + r2_sd), width = 0.2) +\n  scale_fill_manual(values = pal_bg) +\n  labs(title = \"5-fold CV: R² (mean ± sd)\", subtitle = paste0(\"N = \", n_cv),\n       x = NULL, y = \"R²\") + theme_bg()\np_rmse &lt;- ggplot(cv_sum, aes(x = factor(model, levels=c(\"A\",\"B\")), y = rmse_mean, fill = model)) +\n  geom_col(width = 0.6, show.legend = FALSE) +\n  geom_errorbar(aes(ymin = rmse_mean - rmse_sd, ymax = rmse_mean + r2_sd), width = 0.2) +\n  scale_fill_manual(values = pal_bg) +\n  labs(title = \"5-fold CV: RMSE (mean ± sd)\", subtitle = paste0(\"N = \", n_cv),\n       x = NULL, y = \"RMSE\") + theme_bg()\nprint(p_cv + p_rmse)\n\n\n\npred_A &lt;- augment(fit_A) |&gt; mutate(model = \"A_Top\")\npred_B &lt;- augment(fit_B) |&gt; mutate(model = \"B_Decol\")\np_fit &lt;- bind_rows(pred_A, pred_B) |&gt;\n  ggplot(aes(.fitted, total, color = model)) +\n  geom_point(alpha = 0.7) +\n  geom_abline(slope = 1, intercept = 0, linetype = 2, color = \"#334155\") +\n  scale_color_manual(values = pal_bg) +\n  labs(title = \"Observed vs Fitted (A vs B)\", x = \"Fitted Total Score\", y = \"Observed Total Score\") +\n  theme_bg()\np_res &lt;- bind_rows(pred_A, pred_B) |&gt;\n  ggplot(aes(.fitted, .resid, color = model)) +\n  geom_point(alpha = 0.7) + geom_hline(yintercept = 0, linetype = 2, color = \"#334155\") +\n  scale_color_manual(values = pal_bg) +\n  labs(title = \"Residuals vs Fitted (A vs B)\", x = \"Fitted values\", y = \"Residuals\") +\n  theme_bg()\nprint(p_fit); print(p_res)\n\n\n\n\n\n\nbpA &lt;- bptest(fit_A); swA &lt;- if (nrow(dat_A)&lt;=5000) shapiro.test(residuals(fit_A)) else list(p.value = NA)\nbpB &lt;- bptest(fit_B); swB &lt;- if (nrow(dat_B2)&lt;=5000) shapiro.test(residuals(fit_B)) else list(p.value = NA)\n\ncat(\"\\n==== SUMMARY ====\\n\")\n\n\n==== SUMMARY ====\n\ncat(\"Top vars (orig -&gt; safe):\\n\"); print(map_A)\n\nTop vars (orig -&gt; safe):\n\n\n# A tibble: 5 × 2\n  orig                                         safe \n  &lt;chr&gt;                                        &lt;chr&gt;\n1 self_management_scale_measure                x1   \n2 self_management_scale_diet_days              x2   \n3 self_management_scale_shoes                  x3   \n4 self_management_scale_diet_control           x4   \n5 self_management_scale_blood_sugar_monitoring x5   \n\ncat(\"\\nModel A (Top OLS): adj.R2 =\", round(A_gl$adj.r.squared,3),\n    \" | BP p =\", signif(bpA$p.value,3),\n    \" | SW p =\", ifelse(is.null(swA$p.value), NA, signif(swA$p.value,3)), \"\\n\")\n\n\nModel A (Top OLS): adj.R2 = 0.749  | BP p = 0.0911  | SW p = 0.000201 \n\ncat(\"Model B (Decol OLS): adj.R2 =\", round(B_gl$adj.r.squared,3),\n    \" | BP p =\", signif(bpB$p.value,3),\n    \" | SW p =\", ifelse(is.null(swB$p.value), NA, signif(swB$p.value,3)), \"\\n\")\n\nModel B (Decol OLS): adj.R2 = 0.745  | BP p = 0.101  | SW p = 5.71e-05 \n\nif (!is.null(vif_B)) { cat(\"\\nVIF (Model B):\\n\"); print(vif_B) }\n\n\nVIF (Model B):\n      x1       x3       x4       x5 \n2.370141 1.580013 1.393228 2.251082"
  },
  {
    "objectID": "analysis.html#summary",
    "href": "analysis.html#summary",
    "title": "Example analysis",
    "section": "",
    "text": "In this hospital sample of adults with T2DM, probable depression (PHQ-9 ≥ 10) was common and varied by sex and age. Higher depressive symptom burden showed a modest positive association with HbA1c, and a clear negative association with the dataset's \"Total Score\", which likely captures better self-management or health status. A simple logistic regression using HbA1c, age, sex, and Total Score provided interpretable odds ratios with sensible directions of effect. While results are cross-sectional and rely on screening (not diagnosis), they demonstrate how routinely collected variables can prioritize patients for further mental-health assessment. Future work could validate the model prospectively and incorporate more granular self-management behaviors."
  },
  {
    "objectID": "analysis.html#functions-checklist",
    "href": "analysis.html#functions-checklist",
    "title": "Example analysis",
    "section": "",
    "text": "dplyr: mutate(), across(), filter(), select(), rename(), case_when(), group_by(), summarise(), recode(), glimpse()\ntidyr: drop_na(), pivot_longer() (if you extend item handling), replace_na(), unite() (optional)\nggplot2 (geoms): geom_histogram(), geom_col(), geom_point(), geom_smooth(), geom_pointrange(), plus facet_wrap()\n\nRecent evidence highlights precision subtyping of diabetes (Weng 2022; World Health Organization 2024)."
  }
]